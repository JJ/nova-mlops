<!doctype html>
<html>
    <head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>MlOps@Nova by JJ Merelo: Session 1</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/mlops-preso.css">
        <link rel="stylesheet" href="dist/extra.css">
        <link rel="stylesheet" href="dist/mlops.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
    </head>
    <body>
      <div class="reveal">
	<div class="slides">
	  <section>
            <h2>Third session: Infrastructure and containers</h2>
            <h1>MLOps at Nova</h1>
            <h3>JJ Merelo, <a href="https://twitter.com/jjmerelo"><code>@jjmerelo</code></a></h3>
          </section>
	  
	  <section><h1>What did you learn yesterday</h1>
	    <h2 class='fragment'>Is there some left over work
	      from yesterday's sprint</h2>
	    <h3 class='fragment'>Ready to start next
	      MVP/milestone?</h3>
	  </section>

	  <section> <!-- Learn about dependency managers -->

	  <section><h1>MLOps is about <em>repeatable</em> worlflows</h1>
	    <h2 class='fragment'>There should be a single way of describing dependencies</h2>
	    <h3 class='fragment'>And also language version</h3>
	  </section>

	  <section><h1>Use best practices dependency management</h1>
	    <h2 class='fragment'>Use <code>poetry</code></h2>
	  </section>

	  <section><h1>Poetry for my data</h1>
	    <pre><code data-line-numbers='1,8|1-6|8-14|9'>[tool.poetry]
name = "nova_mlops"
version = "0.1.0"
description = "Example for NOVA MLOps course"
authors = ["JJ Merelo &lt;jjmerelo@gmail.com>"]
license = "GPL 3.0"

[tool.poetry.dependencies]
python = "^3.9"
neptune-client = "^0.16.2"
python-dotenv = "^0.20.0"
mlflow = "^1.27.0"
numpy = "^1.23.0"</code></pre>
	  </section>

	  <section><h1>Dependency managers become task managers</h1>
	    <h2 class='fragment'>Tasks managed for you</h2>
	  </section>

	  <section><h1>Tasks managers manage your workflows</h1>
	    <h2 class='fragment'>So that you need not do it</h2>
	  </section>

	  <section><h1>Poetry in motion</h1>
	    <pre><code>[tool.poetry.scripts]
train = 'nova_mlops.__init__:go'
	    </code></pre>

	    <pre class='fragment'><code>poetry run train</code></pre>
	  </section>

	  <section><h3>ðŸ’¼ Activity</h3>
	    <h3>Start a module in the chosen language</h3>
	    <ul>
	      <li>Look for the proper directory layout and naming conventions</li>
	      <li>Declare dependencies, and install them</li>
	      <li>Choose a task manager, and create a simple running task</li>
	    </ul>
	    <aside class='notes'>Working witht the previous downloader</aside>
	  </section>
	</section>

	<section>
	  <section><h1>And now... the tests</h1>
	    <h2 class='fragment'>Tests are essential in DevOps/MLOps</h2>
	    </section>

	  <section><h1>Unit tests ensure that every pipeline step works</h1>
	    <h2 class='fragment'>Thus delivering value to client</h2>
	  </section>

	  <section><h1>Choose wisely your test tools</h1>
	    <aside class='notes'>One of the principles of the course:
	    learn to decide. Agile is about focusing on the client,
	    which is the result, but also focusing on adaptability,
	    meaning that tools should allow you to adapt to new
	    circumstances and should not detract value (by being
	    insecure, or deprecated, or simply not delivering as much
	    value as others)</aside>
	  </section>

	  <section><h1>Testing behaviors</h1>
	    <h2 class='fragment'>Does download work?</h2>
	    <pre><code data-line-numbers='1,2|4-6|11-12'>import pytest
from .. import download, driver

@pytest.fixture
def page():
    return download(14,4)

def test_driver():
    assert driver

def test_download(page):
    assert page
	    </code></pre>
	  </section>

	  <section><h1>ðŸ’¼ Activity</h1>
	    <h2>Add your tests</h2>
	    <h3 class='fragment'>Add a target to the task manager that
	      runs tests</h3>
	    <aside class='notes'>In many cases, it will be totally
	      automatic, in others you will need to add it yourself.</aside>
	  </section>

	</section>

	<section>
	  <section><h1>Extract data</h1>
	    <h2 class='fragment'>DOM or regular expression</h2>
	    <h3 class='fragment'>Often, a combination of both</h3>
	  </section>

	  <section><h1>Regular expression is a powerful language for describing regularities in text</h1>
	    <aside class='notes'>Possibly a bit outside the scope of
	      this course</aside>
	  </section>

	  <section><h1>Don't even try to process some format
	      yourself</h1>
	    <h2 class='fragment'>There's probably a module for that</h2>
	  </section>
	  
	  <section><h1>Also... have a plan B</h1>
	    <h2 class='fragment'>Nothing is guaranteed to work</h2>
	    <h3 class='fragment'>And nothing is guaranteed to work <em>for ever</em></h3>
	    <aside class='notes'>After working for a
	      month or more, the Ukr MoD site started to
	      request a captcha, which is impossible to
	      overcome. At the end of the day, it's a fight
	      human vs technology and human vs. human; you
	      need to invest yourself in the fight... or be
	      defeated.
	    </aside>
	  </section>

	  <section><h1>Test your data!</h1>
	    <pre><code  data-line-numbers='3,6,9|3-11'>subtest "Data is OK", {
    my @dates = $war-data.dates();
    my %prev = $war-data.data{@dates.shift};
    for @dates -> $date {
        for &lt;tanks personnel> -> $k {
            cmp-ok $war-data.data{$date}{$k}&lt;total>, ">=", %prev{$k}Ã‡&lt;total>,
                    "$k for $date: {$war-data.data{$date}{$k}&lt;total>} â‰¥ {%prev{$k}&lt;total>}";
        }
        %prev = $war-data.data{$date};
    }
	    </code></pre>

	    <aside class='notes'>In this case, the total number of
	    losses needs to be monotonically increasing. No space for
	      other options</aside>
	  </section>

	  <section><h1>Difficult decision: what to do if data fails
	      test</h1>
	    <h2 class='fragment'>Not automatically, that's for
	      sure</h2>
	  </section>

	  <section><h1>ðŸ’¼ Activity</h1>
	    <h3 class='fragment'>Create an issue that discusses what
	    are the inherent characteristics of your data (range,
	    possible changes from one instance to next, type of data,
	      and so on and solver it with a PR that creates the test</h3>
	  </section>

	</section>
	    </div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>Reveal.initialize({
	     hash: true,
             width: "95%",
             height: '100%',
             controls: true,
             progress: true,
             backgroundTransition: 'convex',
	     // Learn about plugins: https://revealjs.com/plugins/
	     plugins: [ RevealHighlight, RevealNotes ]
	 });
	</script>
	</body>
</html>
